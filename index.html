<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RedCab Ambulance - Emergency Medical Service</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Hind:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', 'Hind', sans-serif;
        }

        :root {
            --primary: #D92A27;
            --primary-dark: #B71C1C;
            --primary-light: #FFEBEE;
            --secondary: #f8f9fa;
            --accent: #FF6B6B;
            --text: #2D3748;
            --text-light: #718096;
            --white: #ffffff;
            --success: #48BB78;
            --warning: #ED8936;
            --info: #4299E1;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --radius: 12px;
            --radius-sm: 8px;
            --radius-lg: 16px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        [lang="hi"] {
            font-family: 'Hind', 'Poppins', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: var(--text);
            max-width: 500px;
            margin: 0 auto;
            position: relative;
            min-height: 100vh;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.08);
            overflow-x: hidden;
        }

        .container {
            padding: 20px;
            padding-bottom: 100px;
        }

        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
            padding: 18px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-lg);
            border-bottom-left-radius: var(--radius-lg);
            border-bottom-right-radius: var(--radius-lg);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .logo-icon {
            width: 46px;
            height: 46px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 22px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo h1 {
            font-size: 20px;
            font-weight: 700;
            line-height: 1.2;
            color: var(--white);
        }

        .logo p {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.8);
            letter-spacing: 0.8px;
            font-weight: 500;
        }

        .header-actions {
            display: flex;
            gap: 12px;
        }

        .header-icon {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 18px;
            position: relative;
            transition: var(--transition);
            cursor: pointer;
        }

        .header-icon:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent);
            color: var(--white);
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);
            animation: pulse 2s infinite;
        }

        /* Welcome Banner */
        .welcome-banner {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: var(--radius-lg);
            padding: 25px;
            margin: 20px 0;
            color: var(--white);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
        }

        .welcome-banner::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 120px;
            height: 120px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transform: translate(30px, -30px);
        }

        .welcome-banner::after {
            content: '';
            position: absolute;
            bottom: -20px;
            right: -20px;
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .welcome-text h2 {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 8px;
            line-height: 1.3;
        }

        .welcome-text p {
            font-size: 14px;
            opacity: 0.9;
            line-height: 1.5;
        }

        /* Map Section */
        .map-container {
            height: 280px;
            background: var(--white);
            border-radius: var(--radius-lg);
            margin: 25px 0;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        #map {
            height: 100%;
            width: 100%;
            border-radius: var(--radius-lg);
        }

        .map-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.9) 0%, rgba(118, 75, 162, 0.9) 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            color: var(--white);
            z-index: 10;
        }

        .map-overlay i {
            font-size: 50px;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .map-overlay h3 {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .map-overlay p {
            font-size: 15px;
            opacity: 0.9;
        }

        .current-location-btn {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 54px;
            height: 54px;
            border-radius: 50%;
            background: var(--white);
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-xl);
            font-size: 22px;
            z-index: 10;
            transition: var(--transition);
            cursor: pointer;
        }

        .current-location-btn:hover {
            transform: scale(1.1) rotate(15deg);
            box-shadow: var(--shadow-xl);
        }

        /* Location Inputs */
        .location-inputs {
            background-color: var(--white);
            border-radius: var(--radius-lg);
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(0, 0, 0, 0.03);
            position: relative;
        }

        .location-inputs::before {
            content: '';
            position: absolute;
            left: 30px;
            top: 50%;
            transform: translateY(-50%);
            width: 2px;
            height: 60%;
            background: linear-gradient(to bottom, var(--primary), var(--primary-dark));
            border-radius: 2px;
        }

        .location-item {
            display: flex;
            align-items: center;
            gap: 18px;
            padding: 16px 0;
        }

        .location-icon {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 18px;
            box-shadow: 0 4px 12px rgba(217, 42, 39, 0.3);
            z-index: 2;
        }

        .location-text {
            flex: 1;
        }

        .location-text input {
            width: 100%;
            border: none;
            outline: none;
            font-size: 16px;
            padding: 10px 0;
            background: transparent;
            font-weight: 500;
            color: var(--text);
        }

        .location-text input::placeholder {
            color: var(--text-light);
            font-weight: 400;
        }

        .location-divider {
            height: 1px;
            background: linear-gradient(to right, transparent, #e2e8f0, transparent);
            margin: 8px 0;
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin: 25px 0;
        }

        .quick-action {
            background: var(--white);
            border-radius: var(--radius);
            padding: 18px 12px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            border: 1px solid rgba(0, 0, 0, 0.03);
        }

        .quick-action:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .quick-action i {
            font-size: 22px;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .quick-action span {
            font-size: 12px;
            font-weight: 600;
            color: var(--text);
            display: block;
        }

        /* Distance Info */
        .distance-info {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: var(--radius-lg);
            padding: 20px 25px;
            margin: 20px 0;
            box-shadow: var(--shadow-lg);
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--white);
        }

        .distance-label {
            font-weight: 600;
            font-size: 16px;
            opacity: 0.9;
        }

        .distance-value {
            font-weight: 800;
            font-size: 24px;
        }

        /* Fare Estimation */
        .fare-estimation {
            background-color: var(--white);
            border-radius: var(--radius-lg);
            padding: 25px;
            margin: 20px 0;
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(0, 0, 0, 0.03);
            display: none;
            position: relative;
            overflow: hidden;
        }

        .fare-estimation::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, var(--primary), var(--primary-dark));
        }

        .fare-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .fare-title {
            font-weight: 700;
            font-size: 18px;
            color: var(--text);
        }

        .fare-amount {
            font-weight: 800;
            color: var(--primary);
            font-size: 26px;
        }

        .fare-breakdown {
            border-top: 1px solid #f1f5f9;
            padding-top: 20px;
        }

        .fare-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 15px;
        }

        .fare-label {
            color: var(--text-light);
        }

        .fare-value {
            font-weight: 600;
        }

        /* Ambulance Types Grid */
        .ambulance-types {
            margin: 30px 0;
        }

        .section-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--text);
            position: relative;
            padding-left: 15px;
        }

        .section-title::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: linear-gradient(to bottom, var(--primary), var(--primary-dark));
            border-radius: 2px;
        }

        .ambulance-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 18px;
        }

        .ambulance-card {
            background-color: var(--white);
            border-radius: var(--radius-lg);
            padding: 25px 20px;
            box-shadow: var(--shadow);
            border: 2px solid transparent;
            transition: var(--transition);
            text-align: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .ambulance-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            transform: scaleX(0);
            transition: var(--transition);
        }

        .ambulance-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
        }

        .ambulance-card.active {
            border-color: var(--primary);
            background: var(--primary-light);
            transform: translateY(-5px);
        }

        .ambulance-card.active::before {
            transform: scaleX(1);
        }

        .ambulance-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 32px;
            margin: 0 auto 18px;
            box-shadow: 0 8px 20px rgba(217, 42, 39, 0.3);
            transition: var(--transition);
        }

        .ambulance-card:hover .ambulance-icon {
            transform: scale(1.1);
        }

        .ambulance-name {
            font-weight: 700;
            margin-bottom: 12px;
            font-size: 17px;
            color: var(--text);
        }

        .ambulance-features {
            font-size: 13px;
            color: var(--text-light);
            margin-bottom: 18px;
            line-height: 1.5;
            min-height: 40px;
        }

        .ambulance-price {
            font-weight: 800;
            color: var(--primary);
            font-size: 22px;
        }

        /* Book Button */
        .book-btn {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
            border: none;
            border-radius: var(--radius-lg);
            padding: 20px 30px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 14px;
            box-shadow: 0 8px 20px rgba(217, 42, 39, 0.4);
            margin: 30px 0;
            position: relative;
            overflow: hidden;
        }

        .book-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
        }

        .book-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(217, 42, 39, 0.5);
        }

        .book-btn:hover::before {
            left: 100%;
        }

        .book-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .book-btn:disabled:hover::before {
            left: -100%;
        }

        /* Contact Section */
        .contact-section {
            background-color: var(--white);
            border-radius: var(--radius-lg);
            padding: 28px;
            box-shadow: var(--shadow-lg);
            margin-top: 30px;
            border: 1px solid rgba(0, 0, 0, 0.03);
        }

        .contact-title {
            font-weight: 700;
            margin-bottom: 22px;
            font-size: 20px;
            color: var(--text);
            position: relative;
            padding-left: 15px;
        }

        .contact-title::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: linear-gradient(to bottom, var(--primary), var(--primary-dark));
            border-radius: 2px;
        }

        .contact-options {
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

        .contact-option {
            display: flex;
            align-items: center;
            gap: 18px;
            padding: 20px;
            border-radius: var(--radius-lg);
            background: var(--secondary);
            transition: var(--transition);
            cursor: pointer;
            border: 1px solid transparent;
        }

        .contact-option:hover {
            background: var(--white);
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-light);
        }

        .contact-icon {
            width: 58px;
            height: 58px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 6px 15px rgba(217, 42, 39, 0.3);
            transition: var(--transition);
        }

        .contact-option:hover .contact-icon {
            transform: scale(1.1);
        }

        .contact-text {
            flex: 1;
        }

        .contact-label {
            font-weight: 700;
            margin-bottom: 6px;
            color: var(--text);
            font-size: 16px;
        }

        .contact-value {
            font-size: 15px;
            color: var(--text-light);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--white);
            display: flex;
            justify-content: space-around;
            padding: 18px 0;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            max-width: 500px;
            margin: 0 auto;
            z-index: 100;
            border-top-left-radius: var(--radius-lg);
            border-top-right-radius: var(--radius-lg);
            backdrop-filter: blur(10px);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            color: var(--text-light);
            font-size: 12px;
            transition: var(--transition);
            cursor: pointer;
            padding: 10px 14px;
            border-radius: var(--radius);
            position: relative;
        }

        .nav-item:hover {
            color: var(--primary);
            background: var(--primary-light);
        }

        .nav-item.active {
            color: var(--primary);
            background: var(--primary-light);
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            top: -18px;
            width: 30px;
            height: 3px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: 2px;
        }

        .nav-icon {
            font-size: 22px;
        }

        /* Emergency Button */
        .emergency-btn {
            position: fixed;
            bottom: 90px;
            right: 25px;
            width: 68px;
            height: 68px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent) 0%, #ff4757 100%);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.6);
            font-size: 28px;
            z-index: 90;
            animation: pulse 2s infinite;
            cursor: pointer;
            transition: var(--transition);
            border: 3px solid var(--white);
        }

        .emergency-btn:hover {
            transform: scale(1.15);
            box-shadow: 0 12px 30px rgba(255, 107, 107, 0.8);
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 4px 15px rgba(255, 107, 107, 0.6);
            }
            50% {
                box-shadow: 0 4px 25px rgba(255, 107, 107, 1);
            }
            100% {
                box-shadow: 0 4px 15px rgba(255, 107, 107, 0.6);
            }
        }

        /* Hidden screens */
        .screen {
            display: none;
        }

        .active-screen {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Login Screen Styles */
        .login-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 100vh;
            padding: 30px 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            position: relative;
        }

        .login-logo {
            text-align: center;
            margin-bottom: 50px;
        }

        .logo-graphic {
            width: 130px;
            height: 130px;
            border-radius: 30px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 30px;
            box-shadow: 0 15px 30px rgba(217, 42, 39, 0.3);
            position: relative;
            overflow: hidden;
        }

        .logo-graphic::before {
            content: '';
            position: absolute;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            top: 15px;
            left: 15px;
        }

        .logo-graphic i {
            font-size: 55px;
            color: white;
        }

        .login-title {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 12px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .login-subtitle {
            font-size: 17px;
            color: var(--text-light);
            margin-bottom: 50px;
            font-weight: 500;
        }

        .form-group {
            margin-bottom: 28px;
        }

        .form-label {
            display: block;
            margin-bottom: 12px;
            font-weight: 600;
            color: var(--text);
            font-size: 16px;
        }

        .form-input {
            width: 100%;
            padding: 18px 22px;
            border: 2px solid #e2e8f0;
            border-radius: var(--radius-lg);
            font-size: 16px;
            transition: var(--transition);
            background: var(--white);
            box-shadow: var(--shadow);
        }

        .form-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(217, 42, 39, 0.2);
        }

        .login-footer {
            text-align: center;
            margin-top: 40px;
            color: var(--text-light);
            font-size: 14px;
            font-weight: 500;
        }

        /* OTP Screen Styles */
        .otp-inputs {
            display: flex;
            justify-content: space-between;
            margin: 25px 0;
        }

        .otp-input {
            width: 55px;
            height: 65px;
            text-align: center;
            font-size: 26px;
            font-weight: 700;
            border: 2px solid #e2e8f0;
            border-radius: var(--radius);
            transition: var(--transition);
            background: var(--white);
            box-shadow: var(--shadow);
        }

        .otp-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(217, 42, 39, 0.2);
        }

        /* Profile Setup Screen */
        .profile-setup-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 100vh;
            padding: 30px 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
        }

        /* Booking Card Styles */
        .booking-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-lg);
            margin-bottom: 20px;
            border-left: 5px solid var(--primary);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .booking-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(217, 42, 39, 0.03) 0%, rgba(183, 28, 28, 0.03) 100%);
            z-index: 0;
        }

        .booking-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
        }

        .booking-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 18px;
            position: relative;
            z-index: 1;
        }

        .booking-id {
            font-weight: 800;
            color: var(--primary);
            font-size: 17px;
        }

        .booking-type {
            font-size: 15px;
            color: var(--text);
            font-weight: 600;
        }

        .booking-price {
            font-weight: 800;
            color: var(--primary);
            font-size: 20px;
        }

        .booking-status {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
        }

        .status-completed {
            background: #e6fffa;
            color: var(--success);
        }

        .status-progress {
            background: #fffaf0;
            color: var(--warning);
        }

        .status-cancelled {
            background: #fed7d7;
            color: var(--primary);
        }

        .status-agent {
            background: #e6f7ff;
            color: var(--info);
        }

        .booking-details {
            display: flex;
            justify-content: space-between;
            font-size: 13px;
            color: var(--text-light);
            position: relative;
            z-index: 1;
        }

        .booking-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            position: relative;
            z-index: 1;
        }

        .action-btn {
            flex: 1;
            padding: 12px;
            border-radius: var(--radius);
            border: none;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            font-size: 13px;
        }

        .cancel-btn {
            background: #fed7d7;
            color: var(--primary);
        }

        .cancel-btn:hover {
            background: #feb2b2;
        }

        .track-btn {
            background: #e6f7ff;
            color: var(--info);
        }

        .track-btn:hover {
            background: #bae7ff;
        }

        .rate-btn {
            background: #e6fffa;
            color: var(--success);
        }

        .rate-btn:hover {
            background: #b2f5ea;
        }

        /* Driver Info Styles */
        .driver-info {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .driver-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            box-shadow: 0 8px 20px rgba(217, 42, 39, 0.3);
        }

        .driver-details {
            flex: 1;
        }

        .driver-name {
            font-weight: 700;
            font-size: 22px;
            margin-bottom: 8px;
        }

        .driver-rating {
            color: #ffc107;
            margin-bottom: 12px;
        }

        .driver-vehicle {
            background: var(--primary-light);
            color: var(--primary);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            display: inline-block;
            font-weight: 700;
        }

        /* Language Toggle */
        .language-toggle {
            position: absolute;
            top: 25px;
            right: 25px;
            background: var(--white);
            border-radius: 20px;
            padding: 10px 18px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: var(--transition);
            z-index: 10;
            font-weight: 600;
        }

        .language-toggle:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-xl);
        }

        .language-flag {
            font-size: 20px;
        }

        .language-text {
            font-size: 14px;
            font-weight: 700;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 16px 28px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            z-index: 1000;
            font-weight: 700;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            opacity: 0;
            visibility: hidden;
        }

        .toast.show {
            opacity: 1;
            visibility: visible;
            top: 120px;
        }

        /* Profile Screen */
        .profile-section {
            background-color: var(--white);
            border-radius: var(--radius-lg);
            padding: 28px;
            box-shadow: var(--shadow-lg);
            margin-bottom: 20px;
            border: 1px solid rgba(0, 0, 0, 0.03);
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
        }

        .profile-avatar {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            box-shadow: 0 8px 20px rgba(217, 42, 39, 0.3);
        }

        .profile-details {
            flex: 1;
        }

        .profile-name {
            font-weight: 700;
            font-size: 22px;
            margin-bottom: 8px;
        }

        .profile-phone {
            color: var(--text-light);
            font-size: 15px;
        }

        .profile-menu {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .profile-item {
            display: flex;
            align-items: center;
            gap: 18px;
            padding: 18px;
            border-radius: var(--radius-lg);
            background-color: var(--secondary);
            transition: var(--transition);
            cursor: pointer;
            border: 1px solid transparent;
        }

        .profile-item:hover {
            background-color: var(--white);
            transform: translateY(-3px);
            box-shadow: var(--shadow);
            border-color: var(--primary-light);
        }

        .profile-item i {
            width: 24px;
            text-align: center;
            color: var(--primary);
            font-size: 18px;
        }

        /* Loading Spinner */
        .loading {
            display: inline-block;
            width: 22px;
            height: 22px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Rating Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal {
            background: white;
            border-radius: var(--radius-lg);
            padding: 30px;
            width: 100%;
            max-width: 400px;
            box-shadow: var(--shadow-xl);
            animation: modalAppear 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes modalAppear {
            from { opacity: 0; transform: scale(0.8) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .modal-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
            color: var(--text);
        }

        .rating-stars {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin: 25px 0;
        }

        .rating-star {
            font-size: 36px;
            color: #e2e8f0;
            cursor: pointer;
            transition: var(--transition);
        }

        .rating-star.active {
            color: #ffc107;
            transform: scale(1.2);
        }

        .rating-text {
            text-align: center;
            margin-bottom: 25px;
            color: var(--text-light);
            font-size: 16px;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
        }

        .modal-btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: var(--radius);
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            font-size: 15px;
        }

        .cancel-modal {
            background: #f7fafc;
            color: var(--text);
        }

        .cancel-modal:hover {
            background: #edf2f7;
        }

        .submit-rating {
            background: var(--primary);
            color: white;
        }

        .submit-rating:hover {
            background: var(--primary-dark);
        }

        /* Confirmation Screen */
        .confirmation-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 30px;
            box-shadow: var(--shadow-xl);
            margin-bottom: 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .confirmation-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(135deg, var(--success) 0%, #2e7d32 100%);
        }

        .confirmation-icon {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--success) 0%, #2e7d32 100%);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            margin: 0 auto 25px;
            box-shadow: 0 8px 20px rgba(76, 175, 80, 0.3);
        }

        .confirmation-title {
            font-size: 26px;
            font-weight: 800;
            margin-bottom: 12px;
            color: var(--success);
        }

        .confirmation-details {
            background: #f8f9fa;
            border-radius: var(--radius-lg);
            padding: 25px;
            margin: 25px 0;
            text-align: left;
            border: 1px solid #e9ecef;
        }

        .confirmation-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 15px;
        }

        .confirmation-label {
            color: var(--text-light);
            font-weight: 500;
        }

        .confirmation-value {
            font-weight: 700;
        }

        .confirmation-actions {
            display: flex;
            gap: 12px;
            margin-top: 25px;
        }

        /* Error States */
        .error-message {
            color: var(--primary);
            font-size: 14px;
            margin-top: 8px;
            display: none;
            font-weight: 600;
        }

        .input-error {
            border-color: var(--primary) !important;
            box-shadow: 0 0 0 3px rgba(217, 42, 39, 0.2) !important;
        }

        /* Agent Assignment Notice */
        .agent-notice {
            background: #e6f7ff;
            border-radius: var(--radius);
            padding: 18px;
            margin: 18px 0;
            border-left: 4px solid var(--info);
            position: relative;
            z-index: 1;
        }

        .agent-notice i {
            color: var(--info);
            margin-right: 12px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Rating Modal -->
    <div class="modal-overlay" id="rating-modal" style="display: none;">
        <div class="modal">
            <div class="modal-title" data-en="Rate Your Experience" data-hi="‡§Ö‡§™‡§®‡•á ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§ï‡•ã ‡§∞‡•á‡§ü‡§ø‡§Ç‡§ó ‡§¶‡•á‡§Ç">Rate Your Experience</div>
            <div class="rating-stars">
                <i class="fas fa-star rating-star" data-rating="1"></i>
                <i class="fas fa-star rating-star" data-rating="2"></i>
                <i class="fas fa-star rating-star" data-rating="3"></i>
                <i class="fas fa-star rating-star" data-rating="4"></i>
                <i class="fas fa-star rating-star" data-rating="5"></i>
            </div>
            <div class="rating-text" id="rating-text" data-en="Tap a star to rate" data-hi="‡§∞‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§ü‡§æ‡§∞ ‡§ü‡•à‡§™ ‡§ï‡§∞‡•á‡§Ç">Tap a star to rate</div>
            <div class="modal-actions">
                <button class="modal-btn cancel-modal" onclick="closeRatingModal()" data-en="Cancel" data-hi="‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç">Cancel</button>
                <button class="modal-btn submit-rating" onclick="submitRating()" data-en="Submit" data-hi="‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç">Submit</button>
            </div>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="login-screen" class="screen active-screen">
        <div class="login-container">
            <div class="language-toggle" onclick="toggleLanguage()">
                <span class="language-flag">üåê</span>
                <span class="language-text" id="language-text">English</span>
            </div>
            
            <div class="login-logo">
                <div class="logo-graphic">
                    <i class="fas fa-ambulance"></i>
                </div>
                <h1 class="login-title">RedCab Ambulance</h1>
                <p class="login-subtitle" data-en="Emergency Medical Service" data-hi="‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ ‡§∏‡•á‡§µ‡§æ">Emergency Medical Service</p>
            </div>

            <div style="background: var(--white); padding: 35px; border-radius: var(--radius-lg); box-shadow: var(--shadow-xl);">
                <div class="form-group">
                    <label class="form-label" data-en="Phone Number" data-hi="‡§´‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞">Phone Number</label>
                    <input type="tel" class="form-input" placeholder="Enter your 10-digit phone number" id="phone-number" maxlength="10">
                    <div class="error-message" id="phone-error" data-en="Please enter a valid 10-digit phone number" data-hi="‡§ï‡•É‡§™‡§Ø‡§æ ‡§è‡§ï ‡§µ‡•à‡§ß 10-‡§Ö‡§Ç‡§ï‡•Ä‡§Ø ‡§´‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">Please enter a valid 10-digit phone number</div>
                </div>

                <button class="book-btn" onclick="sendOTP()" id="send-otp-btn" data-en="Send OTP" data-hi="OTP ‡§≠‡•á‡§ú‡•á‡§Ç">
                    <i class="fas fa-paper-plane"></i>
                    Send OTP
                </button>
            </div>

            <div class="login-footer">
                <p data-en="24/7 Emergency Ambulance Service" 
                   data-hi="24/7 ‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏ ‡§∏‡•á‡§µ‡§æ">
                   24/7 Emergency Ambulance Service
                </p>
            </div>
        </div>
    </div>

    <!-- OTP Verification Screen -->
    <div id="otp-screen" class="screen">
        <div class="login-container">
            <div class="language-toggle" onclick="toggleLanguage()">
                <span class="language-flag">üåê</span>
                <span class="language-text" id="language-text-otp">English</span>
            </div>
            
            <div class="login-logo">
                <div class="logo-graphic">
                    <i class="fas fa-sms"></i>
                </div>
                <h1 class="login-title">Verify OTP</h1>
                <p class="login-subtitle" data-en="Enter the 6-digit code sent to your phone" data-hi="‡§Ö‡§™‡§®‡•á ‡§´‡•ã‡§® ‡§™‡§∞ ‡§≠‡•á‡§ú‡•á ‡§ó‡§è 6-‡§Ö‡§Ç‡§ï‡•Ä‡§Ø ‡§ï‡•ã‡§° ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">Enter the 6-digit code sent to your phone</p>
            </div>

            <div style="background: var(--white); padding: 35px; border-radius: var(--radius-lg); box-shadow: var(--shadow-xl);">
                <div class="form-group">
                    <label class="form-label" data-en="OTP Code" data-hi="OTP ‡§ï‡•ã‡§°">OTP Code</label>
                    <div class="otp-inputs">
                        <input type="text" class="otp-input" maxlength="1" oninput="moveToNext(this, 1)">
                        <input type="text" class="otp-input" maxlength="1" oninput="moveToNext(this, 2)">
                        <input type="text" class="otp-input" maxlength="1" oninput="moveToNext(this, 3)">
                        <input type="text" class="otp-input" maxlength="1" oninput="moveToNext(this, 4)">
                        <input type="text" class="otp-input" maxlength="1" oninput="moveToNext(this, 5)">
                        <input type="text" class="otp-input" maxlength="1" oninput="moveToNext(this, 6)">
                    </div>
                    <div class="error-message" id="otp-error" data-en="Please enter a valid 6-digit OTP" data-hi="‡§ï‡•É‡§™‡§Ø‡§æ ‡§è‡§ï ‡§µ‡•à‡§ß 6-‡§Ö‡§Ç‡§ï‡•Ä‡§Ø OTP ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">Please enter a valid 6-digit OTP</div>
                </div>

                <button class="book-btn" onclick="verifyOTP()" id="verify-otp-btn" data-en="Verify OTP" data-hi="OTP ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç">
                    <i class="fas fa-check-circle"></i>
                    Verify OTP
                </button>
                
                <div style="text-align: center; margin-top: 25px;">
                    <a href="#" onclick="resendOTP()" style="color: var(--primary); text-decoration: none; font-weight: 600;">
                        <span data-en="Resend OTP" data-hi="OTP ‡§™‡•Å‡§®‡§É ‡§≠‡•á‡§ú‡•á‡§Ç">Resend OTP</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Setup Screen -->
    <div id="profile-setup-screen" class="screen">
        <div class="profile-setup-container">
            <div class="language-toggle" onclick="toggleLanguage()">
                <span class="language-flag">üåê</span>
                <span class="language-text" id="language-text-profile">English</span>
            </div>
            
            <div class="login-logo">
                <div class="logo-graphic">
                    <i class="fas fa-user"></i>
                </div>
                <h1 class="login-title">Complete Profile</h1>
                <p class="login-subtitle" data-en="Please enter your name to continue" data-hi="‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡§æ ‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">Please enter your name to continue</p>
            </div>

            <div style="background: var(--white); padding: 35px; border-radius: var(--radius-lg); box-shadow: var(--shadow-xl);">
                <div class="form-group">
                    <label class="form-label" data-en="Full Name" data-hi="‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ">Full Name</label>
                    <input type="text" class="form-input" placeholder="Enter your full name" id="user-name">
                    <div class="error-message" id="name-error" data-en="Please enter your name" data-hi="‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡§æ ‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">Please enter your name</div>
                </div>

                <button class="book-btn" onclick="saveProfile()" id="save-profile-btn" data-en="Save & Continue" data-hi="‡§∏‡§π‡•á‡§ú‡•á‡§Ç ‡§î‡§∞ ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç">
                    <i class="fas fa-check"></i>
                    Save & Continue
                </button>
            </div>
        </div>
    </div>

    <!-- Home Screen -->
    <div id="home-screen" class="screen">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-ambulance"></i>
                </div>
                <div class="logo-text">
                    <h1>RedCab Ambulance</h1>
                    <p>EMERGENCY MEDICAL SERVICE</p>
                </div>
            </div>
            <div class="header-actions">
                <div class="header-icon" onclick="showNotification()">
                    <i class="fas fa-bell"></i>
                    <div class="notification-badge">2</div>
                </div>
                <div class="header-icon" onclick="showScreen('profile-screen')">
                    <i class="fas fa-user"></i>
                </div>
            </div>
        </header>

        <div class="container">
            <!-- Welcome Banner -->
            <div class="welcome-banner">
                <div class="welcome-text">
                    <h2 data-en="Emergency Ambulance Service" data-hi="‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏ ‡§∏‡•á‡§µ‡§æ">Emergency Ambulance Service</h2>
                    <p data-en="Fast, reliable medical transport when you need it most" data-hi="‡§§‡•á‡§ú, ‡§µ‡§ø‡§∂‡•ç‡§µ‡§∏‡§®‡•Ä‡§Ø ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ ‡§™‡§∞‡§ø‡§µ‡§π‡§® ‡§ú‡§¨ ‡§Ü‡§™‡§ï‡•ã ‡§∏‡§¨‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§ú‡§∞‡•Ç‡§∞‡§§ ‡§π‡•ã">Fast, reliable medical transport when you need it most</p>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <div class="quick-action" onclick="showScreen('bookings-screen')">
                    <i class="fas fa-history"></i>
                    <span data-en="History" data-hi="‡§á‡§§‡§ø‡§π‡§æ‡§∏">History</span>
                </div>
                <div class="quick-action" onclick="showScreen('tracking-screen')">
                    <i class="fas fa-map-marker-alt"></i>
                    <span data-en="Track" data-hi="‡§ü‡•ç‡§∞‡•à‡§ï">Track</span>
                </div>
                <div class="quick-action" onclick="showScreen('profile-screen')">
                    <i class="fas fa-user"></i>
                    <span data-en="Profile" data-hi="‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤">Profile</span>
                </div>
                <div class="quick-action" onclick="callEmergency()">
                    <i class="fas fa-phone"></i>
                    <span data-en="Emergency" data-hi="‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤">Emergency</span>
                </div>
            </div>

            <!-- Location Section -->
            <div class="map-container">
                <div id="map"></div>
                <div class="map-overlay" id="map-overlay">
                    <i class="fas fa-map-marker-alt"></i>
                    <h3 data-en="Current Location Detected" data-hi="‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§∏‡•ç‡§•‡§æ‡§® ‡§™‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ">Current Location Detected</h3>
                    <p id="current-location">Palanganatham, Madurai</p>
                </div>
                <div class="current-location-btn" onclick="getCurrentLocation()">
                    <i class="fas fa-crosshairs"></i>
                </div>
            </div>

            <div class="location-inputs">
                <div class="location-item">
                    <div class="location-icon">
                        <i class="fas fa-location-arrow"></i>
                    </div>
                    <div class="location-text">
                        <input type="text" placeholder="Enter pickup location" id="pickup-location" value="Palanganatham, Madurai" oninput="validateLocationInputs()">
                    </div>
                </div>
                
                <div class="location-divider"></div>
                
                <div class="location-item">
                    <div class="location-icon">
                        <i class="fas fa-flag"></i>
                    </div>
                    <div class="location-text">
                        <input type="text" placeholder="Enter drop location" id="drop-location" oninput="validateLocationInputs()">
                    </div>
                </div>
            </div>

            <!-- Distance Info -->
            <div class="distance-info">
                <div class="distance-label" data-en="Estimated Distance" data-hi="‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§¶‡•Ç‡§∞‡•Ä">Estimated Distance</div>
                <div class="distance-value" id="distance-value">0 km</div>
            </div>

            <!-- Fare Estimation -->
            <div class="fare-estimation" id="fare-estimation">
                <div class="fare-header">
                    <div class="fare-title" data-en="Estimated Fare" data-hi="‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ">Estimated Fare</div>
                    <div class="fare-amount" id="fare-amount">‚Çπ0.00</div>
                </div>
                <div class="fare-breakdown">
                    <div class="fare-item">
                        <div class="fare-label" data-en="Base Fare" data-hi="‡§Ü‡§ß‡§æ‡§∞ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ">Base Fare</div>
                        <div class="fare-value" id="base-fare">‚Çπ0.00</div>
                    </div>
                    <div class="fare-item">
                        <div class="fare-label" data-en="Distance Charge" data-hi="‡§¶‡•Ç‡§∞‡•Ä ‡§∂‡•Å‡§≤‡•ç‡§ï">Distance Charge</div>
                        <div class="fare-value" id="distance-charge">‚Çπ0.00</div>
                    </div>
                    <div class="fare-item">
                        <div class="fare-label" data-en="Service Tax" data-hi="‡§∏‡•á‡§µ‡§æ ‡§ï‡§∞">Service Tax</div>
                        <div class="fare-value" id="service-tax">‚Çπ0.00</div>
                    </div>
                </div>
            </div>

            <!-- Ambulance Types Grid -->
            <div class="ambulance-types">
                <h3 class="section-title" data-en="Select Ambulance Type" data-hi="‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç">Select Ambulance Type</h3>
                
                <div class="ambulance-grid">
                    <!-- Patient Transfer -->
                    <div class="ambulance-card active" onclick="selectAmbulance(this, 'patient-transfer')">
                        <div class="ambulance-icon">
                            <i class="fas fa-procedures"></i>
                        </div>
                        <div class="ambulance-name" data-en="Patient Transfer" data-hi="‡§Æ‡§∞‡•Ä‡§ú ‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§´‡§∞">Patient Transfer</div>
                        <div class="ambulance-features" data-en="Non-emergency patient transport" data-hi="‡§ó‡•à‡§∞-‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§Æ‡§∞‡•Ä‡§ú ‡§™‡§∞‡§ø‡§µ‡§π‡§®">Non-emergency patient transport</div>
                        <div class="ambulance-price" id="price-patient-transfer">‚Çπ65.00</div>
                    </div>
                    
                    <!-- Basic Life Support -->
                    <div class="ambulance-card" onclick="selectAmbulance(this, 'bls')">
                        <div class="ambulance-icon">
                            <i class="fas fa-first-aid"></i>
                        </div>
                        <div class="ambulance-name" data-en="Basic Life Support" data-hi="‡§¨‡•á‡§∏‡§ø‡§ï ‡§≤‡§æ‡§á‡§´ ‡§∏‡§™‡•ã‡§∞‡•ç‡§ü">Basic Life Support</div>
                        <div class="ambulance-features" data-en="Oxygen, first aid, basic equipment" data-hi="‡§ë‡§ï‡•ç‡§∏‡•Ä‡§ú‡§®, ‡§™‡•ç‡§∞‡§æ‡§•‡§Æ‡§ø‡§ï ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ, ‡§¨‡•á‡§∏‡§ø‡§ï ‡§â‡§™‡§ï‡§∞‡§£">Oxygen, first aid, basic equipment</div>
                        <div class="ambulance-price" id="price-bls">‚Çπ75.00</div>
                    </div>
                    
                    <!-- Advance Life Support -->
                    <div class="ambulance-card" onclick="selectAmbulance(this, 'als')">
                        <div class="ambulance-icon">
                            <i class="fas fa-heartbeat"></i>
                        </div>
                        <div class="ambulance-name" data-en="Advance Life Support" data-hi="‡§è‡§°‡§µ‡§æ‡§Ç‡§∏ ‡§≤‡§æ‡§á‡§´ ‡§∏‡§™‡•ã‡§∞‡•ç‡§ü">Advance Life Support</div>
                        <div class="ambulance-features" data-en="Paramedic, ECG, ventilator, emergency drugs" data-hi="‡§™‡•à‡§∞‡§æ‡§Æ‡•á‡§°‡§ø‡§ï, ECG, ‡§µ‡•á‡§Ç‡§ü‡§ø‡§≤‡•á‡§ü‡§∞, ‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§¶‡§µ‡§æ‡§è‡§Ç">Paramedic, ECG, ventilator, emergency drugs</div>
                        <div class="ambulance-price" id="price-als">‚Çπ95.00</div>
                    </div>
                    
                    <!-- Dead Body Small -->
                    <div class="ambulance-card" onclick="selectAmbulance(this, 'deadbody-small')">
                        <div class="ambulance-icon">
                            <i class="fas fa-bed"></i>
                        </div>
                        <div class="ambulance-name" data-en="Dead Body Small" data-hi="‡§°‡•á‡§° ‡§¨‡•â‡§°‡•Ä ‡§∏‡•ç‡§Æ‡•â‡§≤">Dead Body Small</div>
                        <div class="ambulance-features" data-en="Standard vehicle for deceased transport" data-hi="‡§Æ‡•É‡§§‡§ï ‡§™‡§∞‡§ø‡§µ‡§π‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§ü‡•à‡§Ç‡§°‡§∞‡•ç‡§° ‡§µ‡§æ‡§π‡§®">Standard vehicle for deceased transport</div>
                        <div class="ambulance-price" id="price-deadbody-small">‚Çπ85.00</div>
                    </div>
                </div>
            </div>

            <!-- Book Button -->
            <button class="book-btn" onclick="bookAmbulance()" id="book-ambulance-btn" data-en="Book Ambulance Now" data-hi="‡§Ö‡§≠‡•Ä ‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏ ‡§¨‡•Å‡§ï ‡§ï‡§∞‡•á‡§Ç" disabled>
                <i class="fas fa-ambulance"></i>
                Book Ambulance Now
            </button>

            <!-- Contact Section -->
            <div class="contact-section">
                <h3 class="contact-title" data-en="Emergency Contact" data-hi="‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï">Emergency Contact</h3>
                <div class="contact-options">
                    <div class="contact-option" onclick="callNumber('6387465536')">
                        <div class="contact-icon">
                            <i class="fas fa-phone"></i>
                        </div>
                        <div class="contact-text">
                            <div class="contact-label" data-en="Call Now" data-hi="‡§Ö‡§≠‡•Ä ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç">Call Now</div>
                            <div class="contact-value">6387465536</div>
                        </div>
                    </div>
                    
                    <div class="contact-option" onclick="openWhatsApp('6387465536')">
                        <div class="contact-icon">
                            <i class="fab fa-whatsapp"></i>
                        </div>
                        <div class="contact-text">
                            <div class="contact-label" data-en="WhatsApp" data-hi="‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§è‡§™">WhatsApp</div>
                            <div class="contact-value">6387465536</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="bottom-nav">
            <div class="nav-item active" onclick="showScreen('home-screen')">
                <i class="fas fa-home nav-icon"></i>
                <span data-en="Home" data-hi="‡§π‡•ã‡§Æ">Home</span>
            </div>
            <div class="nav-item" onclick="showScreen('bookings-screen')">
                <i class="fas fa-list nav-icon"></i>
                <span data-en="Bookings" data-hi="‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó‡•ç‡§∏">Bookings</span>
            </div>
            <div class="nav-item" onclick="showScreen('tracking-screen')">
                <i class="fas fa-map-marker-alt nav-icon"></i>
                <span data-en="Track" data-hi="‡§ü‡•ç‡§∞‡•à‡§ï">Track</span>
            </div>
            <div class="nav-item" onclick="showScreen('profile-screen')">
                <i class="fas fa-user nav-icon"></i>
                <span data-en="Profile" data-hi="‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤">Profile</span>
            </div>
        </div>

        <div class="emergency-btn" onclick="callEmergency()">
            <i class="fas fa-phone"></i>
        </div>
    </div>

    <!-- Bookings Screen -->
    <div id="bookings-screen" class="screen">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-list"></i>
                </div>
                <div class="logo-text">
                    <h1 data-en="My Bookings" data-hi="‡§Æ‡•á‡§∞‡•Ä ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó‡•ç‡§∏">My Bookings</h1>
                    <p data-en="Booking History" data-hi="‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§á‡§§‡§ø‡§π‡§æ‡§∏">Booking History</p>
                </div>
            </div>
            <div class="header-actions">
                <div class="header-icon" onclick="showScreen('home-screen')">
                    <i class="fas fa-home"></i>
                </div>
            </div>
        </header>

        <div class="container">
            <div class="booking-card">
                <div class="booking-header">
                    <div>
                        <div class="booking-id">#AB001</div>
                        <div class="booking-type" data-en="Patient Transfer" data-hi="‡§Æ‡§∞‡•Ä‡§ú ‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§´‡§∞">Patient Transfer</div>
                    </div>
                    <div style="text-align: right;">
                        <div class="booking-price">‚Çπ65.00</div>
                        <div class="booking-status status-completed" data-en="Completed" data-hi="‡§™‡•Ç‡§∞‡•ç‡§£">Completed</div>
                    </div>
                </div>
                <div class="booking-details">
                    <div>Palanganatham ‚Üí Duraisami Rd</div>
                    <div>15 Dec, 10:30 AM</div>
                </div>
                <div class="booking-actions">
                    <button class="action-btn rate-btn" onclick="openRatingModal('AB001')" data-en="Rate" data-hi="‡§∞‡•á‡§ü‡§ø‡§Ç‡§ó ‡§¶‡•á‡§Ç">Rate</button>
                </div>
            </div>

            <div class="booking-card">
                <div class="booking-header">
                    <div>
                        <div class="booking-id">#AB002</div>
                        <div class="booking-type" data-en="Basic Life Support" data-hi="‡§¨‡•á‡§∏‡§ø‡§ï ‡§≤‡§æ‡§á‡§´ ‡§∏‡§™‡•ã‡§∞‡•ç‡§ü">Basic Life Support</div>
                    </div>
                    <div style="text-align: right;">
                        <div class="booking-price">‚Çπ75.00</div>
                        <div class="booking-status status-agent" data-en="With Agent" data-hi="‡§è‡§ú‡•á‡§Ç‡§ü ‡§ï‡•á ‡§™‡§æ‡§∏">With Agent</div>
                    </div>
                </div>
                <div class="booking-details">
                    <div>Ellis Nagar ‚Üí Government Hospital</div>
                    <div>14 Dec, 03:15 PM</div>
                </div>
                <div class="agent-notice">
                    <i class="fas fa-info-circle"></i>
                    <span data-en="No drivers available nearby. Our agent will contact you shortly." data-hi="‡§Ü‡§∏-‡§™‡§æ‡§∏ ‡§ï‡•ã‡§à ‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§ ‡§π‡§Æ‡§æ‡§∞‡§æ ‡§è‡§ú‡•á‡§Ç‡§ü ‡§Ü‡§™‡§∏‡•á ‡§∂‡•Ä‡§ò‡•ç‡§∞ ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§ï‡§∞‡•á‡§ó‡§æ‡•§">No drivers available nearby. Our agent will contact you shortly.</span>
                </div>
                <div class="booking-actions">
                    <button class="action-btn cancel-btn" onclick="cancelBooking('AB002')" data-en="Cancel" data-hi="‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç">Cancel</button>
                </div>
            </div>

            <div class="booking-card">
                <div class="booking-header">
                    <div>
                        <div class="booking-id">#AB003</div>
                        <div class="booking-type" data-en="Advance Life Support" data-hi="‡§è‡§°‡§µ‡§æ‡§Ç‡§∏ ‡§≤‡§æ‡§á‡§´ ‡§∏‡§™‡•ã‡§∞‡•ç‡§ü">Advance Life Support</div>
                    </div>
                    <div style="text-align: right;">
                        <div class="booking-price">‚Çπ120.00</div>
                        <div class="booking-status status-cancelled" data-en="Cancelled" data-hi="‡§∞‡§¶‡•ç‡§¶">Cancelled</div>
                    </div>
                </div>
                <div class="booking-details">
                    <div>KK Nagar ‚Üí Meenakshi Hospital</div>
                    <div>12 Dec, 05:45 PM</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tracking Screen -->
    <div id="tracking-screen" class="screen">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-map-marker-alt"></i>
                </div>
                <div class="logo-text">
                    <h1 data-en="Live Tracking" data-hi="‡§≤‡§æ‡§á‡§µ ‡§ü‡•ç‡§∞‡•à‡§ï‡§ø‡§Ç‡§ó">Live Tracking</h1>
                    <p data-en="Ambulance Location" data-hi="‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏ ‡§∏‡•ç‡§•‡§æ‡§®">Ambulance Location</p>
                </div>
            </div>
            <div class="header-actions">
                <div class="header-icon" onclick="showScreen('home-screen')">
                    <i class="fas fa-home"></i>
                </div>
            </div>
        </header>

        <div class="container">
            <div class="map-container">
                <div id="tracking-map"></div>
                <div class="map-overlay" id="tracking-overlay">
                    <i class="fas fa-ambulance"></i>
                    <h3 data-en="Ambulance is Arriving" data-hi="‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏ ‡§Ü ‡§∞‡§π‡•Ä ‡§π‡•à">Ambulance is Arriving</h3>
                    <p data-en="ETA: 7 minutes" data-hi="‡§Ü‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§Ø: 7 ‡§Æ‡§ø‡§®‡§ü">ETA: 7 minutes</p>
                </div>
            </div>

            <div style="background: var(--white); padding: 28px; border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); margin-top: 25px;">
                <div class="driver-info">
                    <div class="driver-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="driver-details">
                        <div class="driver-name">Harold</div>
                        <div class="driver-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <span style="color: var(--text); margin-left: 8px;">5.0</span>
                        </div>
                        <div class="driver-vehicle">TN 57 AB 7383</div>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 14px;">
                    <button class="book-btn" onclick="callNumber('6387465536')" style="padding: 16px; font-size: 16px;">
                        <i class="fas fa-phone"></i>
                        <span data-en="Call Driver" data-hi="‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§ï‡•ã ‡§ï‡•â‡§≤">Call Driver</span>
                    </button>
                    <button class="book-btn" onclick="openWhatsApp('6387465536')" style="padding: 16px; font-size: 16px; background: var(--success);">
                        <i class="fab fa-whatsapp"></i>
                        <span data-en="WhatsApp" data-hi="‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§è‡§™">WhatsApp</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Screen -->
    <div id="profile-screen" class="screen">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-user"></i>
                </div>
                <div class="logo-text">
                    <h1 data-en="My Profile" data-hi="‡§Æ‡•á‡§∞‡•Ä ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤">My Profile</h1>
                    <p data-en="Account Details" data-hi="‡§ñ‡§æ‡§§‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£">Account Details</p>
                </div>
            </div>
            <div class="header-actions">
                <div class="header-icon" onclick="showScreen('home-screen')">
                    <i class="fas fa-home"></i>
                </div>
            </div>
        </header>

        <div class="container">
            <div class="profile-section">
                <div class="profile-header">
                    <div class="profile-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="profile-details">
                        <div class="profile-name" id="profile-display-name">John Doe</div>
                        <div class="profile-phone" id="profile-display-phone">+91 9876543210</div>
                    </div>
                </div>
                <div class="profile-menu">
                    <div class="profile-item" onclick="editProfile()">
                        <i class="fas fa-user-edit"></i>
                        <span data-en="Edit Profile" data-hi="‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§∏‡§Ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç">Edit Profile</span>
                    </div>
                    <div class="profile-item" onclick="showToast('Payment Methods clicked')">
                        <i class="fas fa-credit-card"></i>
                        <span data-en="Payment Methods" data-hi="‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§µ‡§ø‡§ß‡§ø‡§Ø‡§æ‡§Å">Payment Methods</span>
                    </div>
                    <div class="profile-item" onclick="showToast('Notifications clicked')">
                        <i class="fas fa-bell"></i>
                        <span data-en="Notifications" data-hi="‡§∏‡•Ç‡§ö‡§®‡§æ‡§è‡§Ç">Notifications</span>
                    </div>
                    <div class="profile-item" onclick="showToast('Help & Support clicked')">
                        <i class="fas fa-question-circle"></i>
                        <span data-en="Help & Support" data-hi="‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§î‡§∞ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§®">Help & Support</span>
                    </div>
                    <div class="profile-item" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                        <span data-en="Logout" data-hi="‡§≤‡•â‡§ó ‡§Ü‡§â‡§ü">Logout</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Booking Confirmation Screen -->
    <div id="confirmation-screen" class="screen">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="logo-text">
                    <h1 data-en="Booking Confirmed" data-hi="‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§π‡•Å‡§à">Booking Confirmed</h1>
                    <p data-en="Ambulance Details" data-hi="‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏ ‡§µ‡§ø‡§µ‡§∞‡§£">Ambulance Details</p>
                </div>
            </div>
            <div class="header-actions">
                <div class="header-icon" onclick="showScreen('home-screen')">
                    <i class="fas fa-home"></i>
                </div>
            </div>
        </header>

        <div class="container">
            <div class="confirmation-card">
                <div class="confirmation-icon">
                    <i class="fas fa-check"></i>
                </div>
                <div class="confirmation-title" data-en="Booking Confirmed!" data-hi="‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§π‡•Å‡§à!">Booking Confirmed!</div>
                <p data-en="Your ambulance is on the way" data-hi="‡§Ü‡§™‡§ï‡•Ä ‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏ ‡§∞‡§æ‡§∏‡•ç‡§§‡•á ‡§Æ‡•á‡§Ç ‡§π‡•à">Your ambulance is on the way</p>
                
                <div class="confirmation-details">
                    <div class="confirmation-item">
                        <div class="confirmation-label" data-en="Booking ID" data-hi="‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§Ü‡§à‡§°‡•Ä">Booking ID</div>
                        <div class="confirmation-value" id="confirm-booking-id">#AB004</div>
                    </div>
                    <div class="confirmation-item">
                        <div class="confirmation-label" data-en="Ambulance Type" data-hi="‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞">Ambulance Type</div>
                        <div class="confirmation-value" id="confirm-ambulance-type">Patient Transfer</div>
                    </div>
                    <div class="confirmation-item">
                        <div class="confirmation-label" data-en="Pickup Location" data-hi="‡§™‡§ø‡§ï‡§Ö‡§™ ‡§∏‡•ç‡§•‡§æ‡§®">Pickup Location</div>
                        <div class="confirmation-value" id="confirm-pickup">Palanganatham, Madurai</div>
                    </div>
                    <div class="confirmation-item">
                        <div class="confirmation-label" data-en="Drop Location" data-hi="‡§°‡•ç‡§∞‡•â‡§™ ‡§∏‡•ç‡§•‡§æ‡§®">Drop Location</div>
                        <div class="confirmation-value" id="confirm-drop">Government Hospital, Madurai</div>
                    </div>
                    <div class="confirmation-item">
                        <div class="confirmation-label" data-en="Estimated Fare" data-hi="‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ">Estimated Fare</div>
                        <div class="confirmation-value" id="confirm-fare">‚Çπ65.00</div>
                    </div>
                    <div class="confirmation-item">
                        <div class="confirmation-label" data-en="Estimated Time" data-hi="‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§∏‡§Æ‡§Ø">Estimated Time</div>
                        <div class="confirmation-value" id="confirm-time">7 minutes</div>
                    </div>
                </div>
                
                <div class="confirmation-actions">
                    <button class="action-btn track-btn" onclick="showScreen('tracking-screen')" style="flex: 2;" data-en="Track Ambulance" data-hi="‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏ ‡§ü‡•ç‡§∞‡•à‡§ï ‡§ï‡§∞‡•á‡§Ç">Track Ambulance</button>
                    <button class="action-btn cancel-btn" onclick="cancelBooking('AB004')" data-en="Cancel" data-hi="‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        let currentLanguage = 'en';
        let selectedAmbulance = 'patient-transfer';
        let currentDistance = 0;
        let map, trackingMap;
        let userLocation = { lat: 9.9252, lng: 78.1198 };
        let currentRating = 0;
        let bookingToRate = '';
        let userData = {
            name: '',
            phone: ''
        };
        
        const ambulanceRates = {
            'patient-transfer': { base: 50, perKm: 10 },
            'bls': { base: 60, perKm: 12 },
            'als': { base: 70, perKm: 15 },
            'deadbody-small': { base: 65, perKm: 13 }
        };
        
        function init() {
            updateLanguage();
            initMap();
            setTimeout(() => {
                calculateDistance();
            }, 500);
        }

        function initMap() {
            map = L.map('map').setView([userLocation.lat, userLocation.lng], 13);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
            
            L.marker([userLocation.lat, userLocation.lng])
                .addTo(map)
                .bindPopup('Your location')
                .openPopup();
            
            trackingMap = L.map('tracking-map').setView([userLocation.lat, userLocation.lng], 13);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(trackingMap);
            
            L.marker([userLocation.lat, userLocation.lng])
                .addTo(trackingMap)
                .bindPopup('Your location')
                .openPopup();
                
            L.marker([userLocation.lat + 0.01, userLocation.lng + 0.01])
                .addTo(trackingMap)
                .bindPopup('Ambulance')
                .openPopup();
        }
        
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'en' ? 'hi' : 'en';
            updateLanguage();
            
            const languageText = document.getElementById('language-text');
            const languageTextOtp = document.getElementById('language-text-otp');
            const languageTextProfile = document.getElementById('language-text-profile');
            if (languageText) languageText.textContent = currentLanguage === 'en' ? 'English' : '‡§π‡§ø‡§Ç‡§¶‡•Ä';
            if (languageTextOtp) languageTextOtp.textContent = currentLanguage === 'en' ? 'English' : '‡§π‡§ø‡§Ç‡§¶‡•Ä';
            if (languageTextProfile) languageTextProfile.textContent = currentLanguage === 'en' ? 'English' : '‡§π‡§ø‡§Ç‡§¶‡•Ä';
        }

        function updateLanguage() {
            document.querySelectorAll('[data-en]').forEach(element => {
                if (currentLanguage === 'en') {
                    element.textContent = element.getAttribute('data-en');
                    if (element.placeholder) {
                        element.placeholder = element.getAttribute('data-en');
                    }
                } else {
                    element.textContent = element.getAttribute('data-hi');
                    if (element.placeholder) {
                        element.placeholder = element.getAttribute('data-hi');
                    }
                }
            });
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active-screen');
            });
            document.getElementById(screenId).classList.add('active-screen');
            
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            if (screenId === 'home-screen') {
                document.querySelectorAll('.nav-item')[0].classList.add('active');
            } else if (screenId === 'bookings-screen') {
                document.querySelectorAll('.nav-item')[1].classList.add('active');
            } else if (screenId === 'tracking-screen') {
                document.querySelectorAll('.nav-item')[2].classList.add('active');
            } else if (screenId === 'profile-screen') {
                document.querySelectorAll('.nav-item')[3].classList.add('active');
            }
            
            if (screenId === 'home-screen' && map) {
                setTimeout(() => {
                    map.invalidateSize();
                }, 100);
            } else if (screenId === 'tracking-screen' && trackingMap) {
                setTimeout(() => {
                    trackingMap.invalidateSize();
                }, 100);
            }
        }

        function moveToNext(input, nextIndex) {
            if (input.value.length === 1) {
                const nextInput = document.querySelectorAll('.otp-input')[nextIndex];
                if (nextInput) {
                    nextInput.focus();
                }
            }
        }

        function selectAmbulance(element, type) {
            document.querySelectorAll('.ambulance-card').forEach(card => {
                card.classList.remove('active');
            });
            element.classList.add('active');
            selectedAmbulance = type;
            updateAmbulancePrices();
            updateFareEstimation();
        }

        function calculateDistance() {
            const pickup = document.getElementById('pickup-location').value;
            const drop = document.getElementById('drop-location').value;
            
            if (pickup && drop) {
                currentDistance = Math.floor(Math.random() * 19) + 2;
                document.getElementById('distance-value').textContent = `${currentDistance} km`;
                updateAmbulancePrices();
                updateFareEstimation();
                document.getElementById('book-ambulance-btn').disabled = false;
            } else {
                document.getElementById('distance-value').textContent = '0 km';
                document.getElementById('book-ambulance-btn').disabled = true;
                document.getElementById('fare-estimation').style.display = 'none';
            }
        }

        function updateAmbulancePrices() {
            for (const ambulanceType in ambulanceRates) {
                const priceElement = document.getElementById(`price-${ambulanceType}`);
                if (priceElement) {
                    const baseRate = ambulanceRates[ambulanceType];
                    const totalPrice = (baseRate.base + (baseRate.perKm * currentDistance)).toFixed(2);
                    priceElement.textContent = `‚Çπ${totalPrice}`;
                }
            }
        }

        function updateFareEstimation() {
            if (currentDistance > 0) {
                const baseRate = ambulanceRates[selectedAmbulance];
                const baseFare = baseRate.base;
                const distanceCharge = baseRate.perKm * currentDistance;
                const serviceTax = (baseFare + distanceCharge) * 0.05;
                const totalFare = baseFare + distanceCharge + serviceTax;
                
                document.getElementById('base-fare').textContent = `‚Çπ${baseFare.toFixed(2)}`;
                document.getElementById('distance-charge').textContent = `‚Çπ${distanceCharge.toFixed(2)}`;
                document.getElementById('service-tax').textContent = `‚Çπ${serviceTax.toFixed(2)}`;
                document.getElementById('fare-amount').textContent = `‚Çπ${totalFare.toFixed(2)}`;
                
                document.getElementById('fare-estimation').style.display = 'block';
            }
        }

        function validateLocationInputs() {
            const pickup = document.getElementById('pickup-location');
            const drop = document.getElementById('drop-location');
            let isValid = true;
            
            if (!pickup.value.trim()) {
                showInputError(pickup, 'Please enter pickup location');
                isValid = false;
            } else {
                clearInputError(pickup);
            }
            
            if (!drop.value.trim()) {
                showInputError(drop, 'Please enter drop location');
                isValid = false;
            } else {
                clearInputError(drop);
            }
            
            if (isValid) {
                calculateDistance();
            }
        }
        
        function showInputError(input, message) {
            input.classList.add('input-error');
        }
        
        function clearInputError(input) {
            input.classList.remove('input-error');
        }

        function sendOTP() {
            const phoneNumber = document.getElementById('phone-number').value;
            const phoneError = document.getElementById('phone-error');
            const sendOtpBtn = document.getElementById('send-otp-btn');
            
            if (phoneNumber.length !== 10 || !/^\d+$/.test(phoneNumber)) {
                phoneError.style.display = 'block';
                return;
            }
            
            phoneError.style.display = 'none';
            userData.phone = phoneNumber;
            
            const originalText = sendOtpBtn.innerHTML;
            sendOtpBtn.innerHTML = '<div class="loading"></div> Sending OTP...';
            sendOtpBtn.disabled = true;
            
            setTimeout(() => {
                showScreen('otp-screen');
                showToast('OTP sent successfully!');
                sendOtpBtn.innerHTML = originalText;
                sendOtpBtn.disabled = false;
                sendToAgentPanel('otp_sent', { phone: phoneNumber });
            }, 2000);
        }

        function verifyOTP() {
            const otpInputs = document.querySelectorAll('.otp-input');
            let otpCode = '';
            let isValid = true;
            
            otpInputs.forEach(input => {
                otpCode += input.value;
                if (!input.value) {
                    isValid = false;
                }
            });
            
            const otpError = document.getElementById('otp-error');
            const verifyOtpBtn = document.getElementById('verify-otp-btn');
            
            if (!isValid || otpCode.length !== 6) {
                otpError.style.display = 'block';
                return;
            }
            
            otpError.style.display = 'none';
            
            const originalText = verifyOtpBtn.innerHTML;
            verifyOtpBtn.innerHTML = '<div class="loading"></div> Verifying...';
            verifyOtpBtn.disabled = true;
            
            setTimeout(() => {
                showScreen('profile-setup-screen');
                verifyOtpBtn.innerHTML = originalText;
                verifyOtpBtn.disabled = false;
                sendToAgentPanel('otp_verified', { 
                    phone: userData.phone,
                    verified: true
                });
            }, 2000);
        }

        function resendOTP() {
            showToast('OTP resent successfully!');
        }

        function saveProfile() {
            const userName = document.getElementById('user-name').value;
            const nameError = document.getElementById('name-error');
            const saveProfileBtn = document.getElementById('save-profile-btn');
            
            if (!userName.trim()) {
                nameError.style.display = 'block';
                return;
            }
            
            nameError.style.display = 'none';
            userData.name = userName;
            
            const originalText = saveProfileBtn.innerHTML;
            saveProfileBtn.innerHTML = '<div class="loading"></div> Saving...';
            saveProfileBtn.disabled = true;
            
            setTimeout(() => {
                document.getElementById('profile-display-name').textContent = userName;
                document.getElementById('profile-display-phone').textContent = '+91 ' + userData.phone;
                showScreen('home-screen');
                saveProfileBtn.innerHTML = originalText;
                saveProfileBtn.disabled = false;
                sendToAgentPanel('profile_created', userData);
            }, 1500);
        }

        function editProfile() {
            document.getElementById('user-name').value = userData.name;
            showScreen('profile-setup-screen');
        }

        function bookAmbulance() {
            const pickup = document.getElementById('pickup-location').value;
            const drop = document.getElementById('drop-location').value;

            if (!pickup || !drop) {
                showToast('Please enter both pickup and drop locations');
                return;
            }

            if (currentDistance === 0) {
                showToast('Please enter valid locations to calculate distance');
                return;
            }

            const bookBtn = document.getElementById('book-ambulance-btn');
            const originalText = bookBtn.innerHTML;
            
            bookBtn.innerHTML = '<div class="loading"></div> Booking...';
            bookBtn.disabled = true;
            
            setTimeout(() => {
                const driversAvailable = Math.random() > 0.5;
                
                if (driversAvailable) {
                    completeBooking(pickup, drop);
                } else {
                    sendToAgent(pickup, drop);
                }
                
                bookBtn.innerHTML = originalText;
                bookBtn.disabled = false;
            }, 3000);
        }

        function completeBooking(pickup, drop) {
            const baseRate = ambulanceRates[selectedAmbulance];
            const baseFare = baseRate.base;
            const distanceCharge = baseRate.perKm * currentDistance;
            const serviceTax = (baseFare + distanceCharge) * 0.05;
            const totalFare = (baseFare + distanceCharge + serviceTax).toFixed(2);
            
            document.getElementById('confirm-booking-id').textContent = '#AB004';
            document.getElementById('confirm-ambulance-type').textContent = 
                document.querySelector('.ambulance-card.active .ambulance-name').textContent;
            document.getElementById('confirm-pickup').textContent = pickup;
            document.getElementById('confirm-drop').textContent = drop;
            document.getElementById('confirm-fare').textContent = `‚Çπ${totalFare}`;
            
            showScreen('confirmation-screen');
            
            setTimeout(() => {
                showToast('Ambulance driver assigned! Tracking available.');
            }, 1000);
            
            sendToAgentPanel('booking_created', {
                bookingId: '#AB004',
                user: userData,
                ambulanceType: selectedAmbulance,
                pickup: pickup,
                drop: drop,
                fare: totalFare,
                status: 'assigned_to_driver'
            });
        }

        function sendToAgent(pickup, drop) {
            const baseRate = ambulanceRates[selectedAmbulance];
            const baseFare = baseRate.base;
            const distanceCharge = baseRate.perKm * currentDistance;
            const serviceTax = (baseFare + distanceCharge) * 0.05;
            const totalFare = (baseFare + distanceCharge + serviceTax).toFixed(2);
            
            document.getElementById('confirm-booking-id').textContent = '#AB005';
            document.getElementById('confirm-ambulance-type').textContent = 
                document.querySelector('.ambulance-card.active .ambulance-name').textContent;
            document.getElementById('confirm-pickup').textContent = pickup;
            document.getElementById('confirm-drop').textContent = drop;
            document.getElementById('confirm-fare').textContent = `‚Çπ${totalFare}`;
            
            showScreen('confirmation-screen');
            
            const confirmationCard = document.querySelector('.confirmation-card');
            const agentNotice = document.createElement('div');
            agentNotice.className = 'agent-notice';
            agentNotice.innerHTML = `
                <i class="fas fa-info-circle"></i>
                <span data-en="No drivers available nearby. Our agent will contact you shortly." data-hi="‡§Ü‡§∏-‡§™‡§æ‡§∏ ‡§ï‡•ã‡§à ‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§ ‡§π‡§Æ‡§æ‡§∞‡§æ ‡§è‡§ú‡•á‡§Ç‡§ü ‡§Ü‡§™‡§∏‡•á ‡§∂‡•Ä‡§ò‡•ç‡§∞ ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§ï‡§∞‡•á‡§ó‡§æ‡•§">No drivers available nearby. Our agent will contact you shortly.</span>
            `;
            confirmationCard.insertBefore(agentNotice, confirmationCard.querySelector('.confirmation-actions'));
            
            updateLanguage();
            
            showToast('Booking sent to agent. They will contact you soon.');
            
            sendToAgentPanel('booking_created', {
                bookingId: '#AB005',
                user: userData,
                ambulanceType: selectedAmbulance,
                pickup: pickup,
                drop: drop,
                fare: totalFare,
                status: 'sent_to_agent'
            });
        }

        function sendToAgentPanel(action, data) {
            console.log('Sending to agent panel:', action, data);
        }

        function getCurrentLocation() {
            if (navigator.geolocation) {
                showToast('Getting your current location...');
                setTimeout(() => {
                    userLocation = { lat: 9.9252, lng: 78.1198 };
                    map.setView([userLocation.lat, userLocation.lng], 13);
                    document.getElementById('map-overlay').style.display = 'none';
                    showToast('Location detected successfully!');
                }, 1500);
            } else {
                showToast('Geolocation is not supported by this browser.');
            }
        }

        // FIXED CALL FUNCTIONALITY
        function callNumber(number) {
            // Check if running on mobile device
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                // For mobile devices, use tel: protocol
                window.location.href = `tel:${number}`;
            } else {
                // For desktop, show a message
                showToast(`Please call ${number} from your phone`);
                // Optionally, you can copy the number to clipboard
                navigator.clipboard.writeText(number).then(() => {
                    showToast(`Phone number ${number} copied to clipboard`);
                });
            }
        }

        // FIXED WHATSAPP FUNCTIONALITY
        function openWhatsApp(number) {
            // Create WhatsApp message
            const message = currentLanguage === 'en' 
                ? 'Hello, I need ambulance service from RedCab.'
                : '‡§®‡§Æ‡§∏‡•ç‡§§‡•á, ‡§Æ‡•Å‡§ù‡•á RedCab ‡§∏‡•á ‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏ ‡§∏‡•á‡§µ‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§';
            
            // Encode the message for URL
            const encodedMessage = encodeURIComponent(message);
            
            // Create WhatsApp URL
            const whatsappURL = `https://wa.me/${number}?text=${encodedMessage}`;
            
            // Open WhatsApp in new tab
            window.open(whatsappURL, '_blank');
        }

        // FIXED EMERGENCY CALL FUNCTION
        function callEmergency() {
            const emergencyNumber = '6387465536';
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                window.location.href = `tel:${emergencyNumber}`;
            } else {
                showToast(`Emergency! Please call ${emergencyNumber} immediately`);
                navigator.clipboard.writeText(emergencyNumber).then(() => {
                    showToast(`Emergency number ${emergencyNumber} copied to clipboard`);
                });
            }
        }

        function showNotification() {
            showToast('You have 2 new notifications');
        }

        function cancelBooking(bookingId) {
            if (confirm(currentLanguage === 'en' ? 'Are you sure you want to cancel this booking?' : '‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§µ‡§æ‡§ï‡§à ‡§á‡§∏ ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?')) {
                showToast('Cancelling booking...');
                setTimeout(() => {
                    showToast('Booking cancelled successfully');
                    sendToAgentPanel('booking_cancelled', { bookingId: bookingId });
                }, 1500);
            }
        }

        function openRatingModal(bookingId) {
            bookingToRate = bookingId;
            currentRating = 0;
            document.getElementById('rating-modal').style.display = 'flex';
            updateRatingStars(0);
        }

        function closeRatingModal() {
            document.getElementById('rating-modal').style.display = 'none';
        }

        function setRating(rating) {
            currentRating = rating;
            updateRatingStars(rating);
            
            const ratingText = document.getElementById('rating-text');
            const texts = [
                currentLanguage === 'en' ? 'Poor' : '‡§ñ‡§∞‡§æ‡§¨',
                currentLanguage === 'en' ? 'Fair' : '‡§†‡•Ä‡§ï-‡§†‡§æ‡§ï',
                currentLanguage === 'en' ? 'Good' : '‡§Ö‡§ö‡•ç‡§õ‡§æ',
                currentLanguage === 'en' ? 'Very Good' : '‡§¨‡§π‡•Å‡§§ ‡§Ö‡§ö‡•ç‡§õ‡§æ',
                currentLanguage === 'en' ? 'Excellent' : '‡§â‡§§‡•ç‡§ï‡•É‡§∑‡•ç‡§ü'
            ];
            
            ratingText.textContent = texts[rating - 1] || (currentLanguage === 'en' ? 'Tap a star to rate' : '‡§∞‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§ü‡§æ‡§∞ ‡§ü‡•à‡§™ ‡§ï‡§∞‡•á‡§Ç');
        }

        function updateRatingStars(rating) {
            const stars = document.querySelectorAll('.rating-star');
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.add('active');
                } else {
                    star.classList.remove('active');
                }
            });
        }

        function submitRating() {
            if (currentRating === 0) {
                showToast(currentLanguage === 'en' ? 'Please select a rating' : '‡§ï‡•É‡§™‡§Ø‡§æ ‡§∞‡•á‡§ü‡§ø‡§Ç‡§ó ‡§ö‡•Å‡§®‡•á‡§Ç');
                return;
            }
            
            showToast('Submitting rating...');
            
            setTimeout(() => {
                closeRatingModal();
                showToast('Thank you for your feedback!');
                sendToAgentPanel('rating_submitted', { 
                    bookingId: bookingToRate, 
                    rating: currentRating 
                });
            }, 1500);
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function logout() {
            showToast('Logging out...');
            setTimeout(() => {
                userData = { name: '', phone: '' };
                document.getElementById('phone-number').value = '';
                document.getElementById('user-name').value = '';
                showScreen('login-screen');
            }, 1500);
        }

        document.addEventListener('DOMContentLoaded', function() {
            const stars = document.querySelectorAll('.rating-star');
            stars.forEach(star => {
                star.addEventListener('click', function() {
                    setRating(parseInt(this.getAttribute('data-rating')));
                });
            });
        });

        init();
    </script>
</body>
</html>
